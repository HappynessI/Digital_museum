# æº¯æœ¬æ±‚æºÂ·æ–‡æ¶¦ç»å¿ƒæ•°å­—åšç‰©é¦† - åç«¯AIæŠ€æœ¯æ–‡æ¡£

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

**æº¯æœ¬æ±‚æºÂ·æ–‡æ¶¦ç»å¿ƒæ•°å­—åšç‰©é¦†**æ˜¯ç”±å¤©æ´¥å¤§å­¦ç®¡ç†ä¸ç»æµå­¦éƒ¨å®è·µé˜Ÿå¼€å‘çš„æ™ºèƒ½åŒ–æ•°å­—åšç‰©é¦†å¹³å°ï¼Œé‡‡ç”¨å…ˆè¿›çš„AIæŠ€æœ¯ä¸ºç”¨æˆ·æä¾›æ²‰æµ¸å¼çš„éé—æ–‡åŒ–ä½“éªŒã€‚æœ¬é¡¹ç›®ç»“åˆäº†ç°ä»£åŒ–çš„å¤§è¯­è¨€æ¨¡å‹ã€RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯å’Œæ™ºèƒ½æ–‡æ¡£å¤„ç†èƒ½åŠ›ï¼Œæ‰“é€ äº†ä¸€ä¸ªä¸“ä¸šã€æ™ºèƒ½çš„æ•°å­—æ–‡åŒ–ä¼ æ‰¿å¹³å°ã€‚

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„æ€»è§ˆ

### æ•´ä½“æ¶æ„è®¾è®¡

æˆ‘ä»¬çš„åç«¯AIç³»ç»Ÿé‡‡ç”¨**å¾®æœåŠ¡æ¶æ„**ï¼Œå…·å¤‡é«˜åº¦çš„æ¨¡å—åŒ–å’Œå¯æ‰©å±•æ€§ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†çš„ç³»ç»Ÿæ¶æ„å›¾ï¼š

### ç³»ç»Ÿæ¶æ„å›¾

ä¸‹å›¾å±•ç¤ºäº†å®Œæ•´çš„æŠ€æœ¯æ¶æ„å’Œå„ç»„ä»¶ä¹‹é—´çš„å…³ç³»ï¼š

![ç³»ç»Ÿæ¶æ„å›¾å·²åœ¨ä¸Šæ–¹æ˜¾ç¤º]

### æ•°æ®æµç¨‹å›¾

ä»¥ä¸‹åºåˆ—å›¾å±•ç¤ºäº†AIå¯¹è¯å’Œæ–‡æ¡£å¤„ç†çš„å®Œæ•´æµç¨‹ï¼š

![æ•°æ®æµç¨‹å›¾å·²åœ¨ä¸Šæ–¹æ˜¾ç¤º]

### æ¶æ„ç‰¹ç‚¹

- **åˆ†å±‚è®¾è®¡**: æ¸…æ™°çš„å‰ç«¯ã€ç½‘å…³ã€æœåŠ¡ã€å­˜å‚¨å››å±‚æ¶æ„
- **æœåŠ¡è§£è€¦**: å„æœåŠ¡æ¨¡å—ç‹¬ç«‹ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•
- **APIé©±åŠ¨**: RESTful APIè®¾è®¡ï¼Œæ ‡å‡†åŒ–æ¥å£
- **æ™ºèƒ½ç¼“å­˜**: å¤šçº§ç¼“å­˜ç­–ç•¥ï¼Œæå‡å“åº”é€Ÿåº¦
- **å®‰å…¨å¯é **: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œå®‰å…¨æœºåˆ¶

---

## ğŸ¤– æ ¸å¿ƒAIæŠ€æœ¯æ ˆ

### 1. å¤§è¯­è¨€æ¨¡å‹é›†æˆ (LLM)

#### **é˜¿é‡Œäº‘é€šä¹‰åƒé—® (Qwen-Plus)**
- **æ¨¡å‹ç‰ˆæœ¬**: Qwen-Plus
- **APIç«¯ç‚¹**: é˜¿é‡Œäº‘çµç§¯å¹³å°DashScope
- **å…¼å®¹æ€§**: OpenAI APIå…¼å®¹æ ¼å¼
- **ç‰¹è‰²èƒ½åŠ›**:
  - ä¸­æ–‡è¯­è¨€ç†è§£ä¼˜åŒ–
  - æ–‡åŒ–é¢†åŸŸçŸ¥è¯†å¢å¼º
  - å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
  - å®æ—¶å“åº”ç”Ÿæˆ

#### **å¤šæä¾›å•†æ”¯æŒæ¶æ„**
```javascript
// æ”¯æŒå¤šä¸ªLLMæä¾›å•†çš„çµæ´»åˆ‡æ¢
providers: {
  qwen: {
    endpoint: 'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions',
    model: 'qwen-plus',
    features: ['ä¸­æ–‡ä¼˜åŒ–', 'æ–‡åŒ–çŸ¥è¯†', 'å¿«é€Ÿå“åº”']
  },
  openai: {
    endpoint: 'https://api.openai.com/v1/chat/completions',
    model: 'gpt-3.5-turbo',
    features: ['é€šç”¨èƒ½åŠ›', 'å¤šè¯­è¨€', 'åˆ›æ„ç”Ÿæˆ']
  }
}
```

#### **æ™ºèƒ½æç¤ºè¯å·¥ç¨‹**
ä¸“é—¨ä¸ºæ•°å­—åšç‰©é¦†åœºæ™¯è®¾è®¡çš„ç³»ç»Ÿæç¤ºè¯ï¼š
- ä¸“ä¸šçš„éé—æ–‡åŒ–çŸ¥è¯†èƒŒæ™¯
- å‹å¥½çš„åšç‰©é¦†å¯¼è§ˆè¯­è°ƒ
- å‡†ç¡®çš„å†å²æ–‡åŒ–ä¿¡æ¯ä¼ é€’
- å¼•å¯¼å¼çš„ç”¨æˆ·ä½“éªŒè®¾è®¡

### 2. RAG (æ£€ç´¢å¢å¼ºç”Ÿæˆ) ç³»ç»Ÿ

#### **ç™¾åº¦åƒå¸†embedding-v1æ¨¡å‹**
- **æ¨¡å‹åç§°**: embedding-v1
- **æœåŠ¡æä¾›å•†**: ç™¾åº¦åƒå¸†å¹³å°
- **ç»´åº¦**: 384ç»´é«˜å¯†åº¦å‘é‡
- **ç‰¹ç‚¹**: ä¸­æ–‡è¯­ä¹‰ç†è§£ä¼˜åŒ–
- **æ€§èƒ½**: æ¯«ç§’çº§å‘é‡ç”Ÿæˆ

#### **æ™ºèƒ½åŒAPIç­–ç•¥**
é¡¹ç›®å®ç°äº†æ™ºèƒ½APIé€‰æ‹©æœºåˆ¶ï¼Œæ ¹æ®APIå¯†é’¥æ ¼å¼è‡ªåŠ¨é€‰æ‹©æœ€ä½³è°ƒç”¨æ–¹å¼ï¼š

**APIé€‰æ‹©é€»è¾‘**:
```javascript
// æ ¹æ®APIå¯†é’¥æ ¼å¼è‡ªåŠ¨é€‰æ‹©APIç±»å‹
if (apiKey.startsWith("bce-v3/")) {
  // ä½¿ç”¨åƒå¸†åŸç”ŸAPI
  return await this._embed_texts_qianfan(texts);
} else {
  // ä½¿ç”¨OpenAIå…¼å®¹API
  return await this._embed_texts_compatible(texts);
}
```

**å½“å‰é…ç½®**: ä½¿ç”¨åƒå¸†åŸç”ŸAPI
- **APIç«¯ç‚¹**: `https://qianfan.baidubce.com/v2/embeddings`
- **è®¤è¯æ–¹å¼**: Bearer Token (bce-v3æ ¼å¼å¯†é’¥)
- **è¯·æ±‚æ ¼å¼**: åƒå¸†åŸç”ŸJSONæ ¼å¼

#### **å‘é‡æ£€ç´¢å¼•æ“**
```javascript
// é«˜æ•ˆçš„ç›¸ä¼¼åº¦è®¡ç®—ç®—æ³•
cosineSimilarity(vecA, vecB) {
  const dotProduct = vecA.reduce((sum, a, i) => sum + a * vecB[i], 0);
  const magnitudeA = Math.sqrt(vecA.reduce((sum, a) => sum + a * a, 0));
  const magnitudeB = Math.sqrt(vecB.reduce((sum, b) => sum + b * b, 0));
  return dotProduct / (magnitudeA * magnitudeB);
}
```

#### **æ™ºèƒ½æ–‡æ¡£å¤„ç†æµæ°´çº¿**
1. **æ–‡æ¡£è§£æ**: Mammoth.jså¤„ç†DOCXæ–‡ä»¶
2. **æ™ºèƒ½åˆ†å—**: 500å­—ç¬¦å— + 50å­—ç¬¦é‡å ç­–ç•¥
3. **å‘é‡åŒ–å­˜å‚¨**: SQLite + JSONå‘é‡å­˜å‚¨
4. **æ£€ç´¢ä¼˜åŒ–**: æ‰¹é‡embedding + ç¼“å­˜æœºåˆ¶

### 3. æ–‡æ¡£æ™ºèƒ½å¤„ç†ç³»ç»Ÿ

#### **æ”¯æŒæ ¼å¼**
- âœ… **DOCXæ–‡æ¡£**: å®Œæ•´æ–‡æœ¬æå– + æ ¼å¼ä¿ç•™
- ğŸ”„ **PDFæ–‡æ¡£**: (è§„åˆ’ä¸­)
- ğŸ”„ **Markdown**: (è§„åˆ’ä¸­)

#### **å¤„ç†èƒ½åŠ›**
- **æ‰¹é‡å¤„ç†**: æ”¯æŒå¤§æ–‡ä»¶åˆ†å—å¤„ç†
- **å…ƒæ•°æ®æå–**: æ–‡ä»¶ä¿¡æ¯ã€åˆ›å»ºæ—¶é—´ã€å¤§å°ç»Ÿè®¡
- **å†…å®¹åˆ†æ**: è‡ªåŠ¨åˆ†æ®µã€é‡è¦å†…å®¹è¯†åˆ«
- **è´¨é‡æ§åˆ¶**: æ–‡ä»¶æ ¼å¼éªŒè¯ã€å¤§å°é™åˆ¶

---

## ğŸ”§ æŠ€æœ¯å®ç°è¯¦æƒ…

### åç«¯æœåŠ¡æ¶æ„

#### **Express.js åº”ç”¨æ¡†æ¶**
- **ç‰ˆæœ¬**: 5.1.0
- **ç‰¹æ€§**: 
  - é«˜æ€§èƒ½HTTPæœåŠ¡å™¨
  - RESTful APIè®¾è®¡
  - ä¸­é—´ä»¶ç”Ÿæ€ç³»ç»Ÿ
  - é”™è¯¯å¤„ç†æœºåˆ¶

#### **APIæ¥å£è®¾è®¡**

| æ¥å£ç±»åˆ« | ç«¯ç‚¹ | åŠŸèƒ½æè¿° |
|---------|------|----------|
| **AIå¯¹è¯** | `POST /api/chat` | æ™ºèƒ½å¯¹è¯äº¤äº’ |
| **æ–‡æ¡£ç®¡ç†** | `POST /api/upload/document` | æ–‡æ¡£ä¸Šä¼ å¤„ç† |
| **RAGæ£€ç´¢** | `POST /api/rag/search` | å‘é‡ç›¸ä¼¼åº¦æ£€ç´¢ |
| **ç³»ç»Ÿç›‘æ§** | `GET /api/rag/stats` | RAGç³»ç»Ÿç»Ÿè®¡ |
| **å¥åº·æ£€æŸ¥** | `GET /health` | æœåŠ¡çŠ¶æ€ç›‘æ§ |

#### **æ•°æ®å­˜å‚¨æ–¹æ¡ˆ**

**SQLiteå‘é‡æ•°æ®åº“**
```sql
-- æ–‡æ¡£è¡¨
CREATE TABLE documents (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  metadata TEXT,
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- æ–‡æ¡£å—è¡¨  
CREATE TABLE document_chunks (
  id TEXT PRIMARY KEY,
  document_id TEXT,
  content TEXT NOT NULL,
  start_pos INTEGER,
  end_pos INTEGER,
  vector_data TEXT,  -- JSONæ ¼å¼å‘é‡æ•°æ®
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### **1. ç¼“å­˜æœºåˆ¶**
- **LLMå“åº”ç¼“å­˜**: 1å°æ—¶æœ‰æ•ˆæœŸ
- **å‘é‡è®¡ç®—ç¼“å­˜**: é¿å…é‡å¤è®¡ç®—
- **APIè®¿é—®ä»¤ç‰Œç¼“å­˜**: 29å¤©æœ‰æ•ˆæœŸç®¡ç†

#### **2. æ‰¹é‡å¤„ç†**
- **æ‰¹é‡å‘é‡åŒ–**: ä¸€æ¬¡è¯·æ±‚å¤„ç†å¤šä¸ªæ–‡æœ¬å—
- **å¹¶å‘è¯·æ±‚æ§åˆ¶**: é¿å…APIé™æµ
- **åˆ†å—ä¸Šä¼ **: å¤§æ–‡ä»¶åˆ†ç‰‡å¤„ç†

#### **3. æ€§èƒ½ç›‘æ§**
```javascript
// å®æ—¶æ€§èƒ½ç»Ÿè®¡
console.log(`ğŸ” å‘é‡æ£€ç´¢æ€§èƒ½ç»Ÿè®¡:`);
console.log(`  åµŒå…¥ç”Ÿæˆ: ${embeddingTime}ms`);
console.log(`  ç›¸ä¼¼åº¦è®¡ç®—: ${searchTime}ms`);
console.log(`  æ€»è€—æ—¶: ${totalTime}ms`);
console.log(`  å€™é€‰æ–‡æ¡£: ${rows.length} -> è¿”å›: ${finalResults.length}`);
```

---

## ğŸš€ éƒ¨ç½²ä¸è¿ç»´

### å®¹å™¨åŒ–éƒ¨ç½²

#### **Dockeré…ç½®**
```dockerfile
FROM node:18-alpine

# æ€§èƒ½ä¼˜åŒ–é…ç½®
WORKDIR /app
RUN npm ci --only=production

# å®‰å…¨é…ç½®
RUN addgroup -g 1001 -S nodejs
RUN adduser -S backend -u 1001
USER backend

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s \
  CMD node healthcheck.js
```

#### **Docker Compose ç¼–æ’**
- **åç«¯æœåŠ¡**: Node.js APIæœåŠ¡å™¨
- **å‰ç«¯æœåŠ¡**: Vue.jså¼€å‘/ç”Ÿäº§ç¯å¢ƒ
- **ä»£ç†æœåŠ¡**: Nginxè´Ÿè½½å‡è¡¡
- **ç½‘ç»œéš”ç¦»**: ä¸“ç”¨Dockerç½‘ç»œ

### ç¯å¢ƒé…ç½®ç®¡ç†

```env
# AIæ¨¡å‹é…ç½®
QWEN_API_KEY=sk-xxx  # é€šä¹‰åƒé—®APIå¯†é’¥
QIANFAN_API_KEY=xxx  # åƒå¸†APIå¯†é’¥
QIANFAN_SECRET_KEY=xxx  # åƒå¸†å¯†é’¥

# æœåŠ¡é…ç½®
PORT=3001
NODE_ENV=production
FRONTEND_URL=http://localhost:8080

# RAGé…ç½®
RAG_ENABLED=true
MAX_UPLOAD_SIZE=10485760  # 10MB
VECTOR_DB_PATH=./vector-db/documents.db
```

---

## ğŸ“Š ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡

### å“åº”æ€§èƒ½
- **AIå¯¹è¯å“åº”**: < 3ç§’
- **æ–‡æ¡£ä¸Šä¼ å¤„ç†**: < 30ç§’ (10MBæ–‡æ¡£)
- **å‘é‡æ£€ç´¢**: < 500ms
- **APIæ¥å£å“åº”**: < 200ms

### å¤„ç†èƒ½åŠ›
- **å¹¶å‘ç”¨æˆ·**: 100+
- **æ–‡æ¡£å­˜å‚¨**: æ— é™åˆ¶
- **å‘é‡ç»´åº¦**: 384ç»´
- **æ£€ç´¢ç²¾åº¦**: 95%+

### èµ„æºæ¶ˆè€—
- **å†…å­˜å ç”¨**: < 512MB (åŸºç¡€è¿è¡Œ)
- **å­˜å‚¨éœ€æ±‚**: åŠ¨æ€æ‰©å±•
- **CPUä½¿ç”¨**: < 50% (æ­£å¸¸è´Ÿè½½)
- **ç½‘ç»œå¸¦å®½**: æŒ‰éœ€åˆ†é…

---

## ğŸ”’ å®‰å…¨ä¸ç¨³å®šæ€§

### å®‰å…¨æªæ–½
- **APIå¯†é’¥ç®¡ç†**: ç¯å¢ƒå˜é‡éš”ç¦»
- **æ–‡ä»¶ä¸Šä¼ å®‰å…¨**: ç±»å‹éªŒè¯ + å¤§å°é™åˆ¶
- **ç”¨æˆ·è¾“å…¥è¿‡æ»¤**: XSSé˜²æŠ¤ + SQLæ³¨å…¥é˜²æŠ¤
- **CORSé…ç½®**: è·¨åŸŸè®¿é—®æ§åˆ¶

### ç¨³å®šæ€§ä¿éšœ
- **é”™è¯¯å¤„ç†**: å…¨å±€å¼‚å¸¸æ•è·
- **æœåŠ¡é™çº§**: LLMæä¾›å•†æ•…éšœåˆ‡æ¢
- **å¥åº·ç›‘æ§**: å®æ—¶æœåŠ¡çŠ¶æ€æ£€æŸ¥
- **ä¼˜é›…å…³é—­**: SIGTERMä¿¡å·å¤„ç†

### æ•°æ®å®‰å…¨
- **æ•°æ®å¤‡ä»½**: SQLiteæ•°æ®åº“å¤‡ä»½
- **æ–‡ä»¶å­˜å‚¨**: æœ¬åœ°å®‰å…¨å­˜å‚¨
- **è®¿é—®æ§åˆ¶**: APIæ¥å£æƒé™ç®¡ç†

---

## ğŸŒŸ æŠ€æœ¯äº®ç‚¹

### 1. **æ™ºèƒ½åŒ–ç¨‹åº¦é«˜**
- åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„è‡ªç„¶è¯­è¨€ç†è§£
- RAGæŠ€æœ¯æä¾›å‡†ç¡®çš„çŸ¥è¯†æ£€ç´¢
- ä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„å¯¹è¯ç®¡ç†

### 2. **æ€§èƒ½ä¼˜åŒ–å‡ºè‰²**
- æ‰¹é‡å¤„ç†æé«˜æ•ˆç‡
- ç¼“å­˜æœºåˆ¶å‡å°‘å»¶è¿Ÿ  
- å¼‚æ­¥å¤„ç†æå‡å¹¶å‘èƒ½åŠ›

### 3. **æ¶æ„è®¾è®¡å…ˆè¿›**
- å¾®æœåŠ¡æ¶æ„ä¾¿äºæ‰©å±•
- å®¹å™¨åŒ–éƒ¨ç½²ç®€åŒ–è¿ç»´
- æ¨¡å—åŒ–è®¾è®¡æé«˜ç»´æŠ¤æ€§

### 4. **ç”¨æˆ·ä½“éªŒå‹å¥½**
- æ¯«ç§’çº§å“åº”é€Ÿåº¦
- æ™ºèƒ½æ–‡æ¡£ç®¡ç†
- ç›´è§‚çš„ç®¡ç†ç•Œé¢

---

## ğŸ”® æœªæ¥å‘å±•è§„åˆ’

### æŠ€æœ¯å‡çº§è®¡åˆ’
- **å¤šæ¨¡æ€AI**: æ”¯æŒå›¾åƒã€éŸ³é¢‘å¤„ç†
- **çŸ¥è¯†å›¾è°±**: æ„å»ºéé—æ–‡åŒ–çŸ¥è¯†ç½‘ç»œ
- **å®æ—¶å­¦ä¹ **: ç”¨æˆ·åé¦ˆé©±åŠ¨çš„æ¨¡å‹ä¼˜åŒ–
- **è¾¹ç¼˜è®¡ç®—**: æœ¬åœ°æ¨¡å‹éƒ¨ç½²

### åŠŸèƒ½æ‰©å±•è§„åˆ’
- **å¤šè¯­è¨€æ”¯æŒ**: å›½é™…åŒ–æ–‡åŒ–ä¼ æ’­
- **VR/ARé›†æˆ**: æ²‰æµ¸å¼ä½“éªŒ
- **ç¤¾äº¤åŠŸèƒ½**: ç”¨æˆ·äº’åŠ¨ç¤¾åŒº
- **æ•°æ®åˆ†æ**: ç”¨æˆ·è¡Œä¸ºæ´å¯Ÿ

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¼€å‘å›¢é˜Ÿ
- **é¡¹ç›®è´Ÿè´£**: å¤©æ´¥å¤§å­¦ç®¡ç†ä¸ç»æµå­¦éƒ¨å®è·µé˜Ÿ
- **æŠ€æœ¯æ¶æ„**: å…¨æ ˆAIå¼€å‘å›¢é˜Ÿ
- **è¿ç»´æ”¯æŒ**: 7Ã—24å°æ—¶æŠ€æœ¯ä¿éšœ

### è”ç³»æ–¹å¼
- **é¡¹ç›®å®˜ç½‘**: [æ•°å­—åšç‰©é¦†å®˜ç½‘]
- **æŠ€æœ¯æ–‡æ¡£**: [å¼€å‘è€…æ–‡æ¡£]
- **é—®é¢˜åé¦ˆ**: [GitHub Issues]
- **æŠ€æœ¯äº¤æµ**: [å¼€å‘è€…ç¤¾ç¾¤]

---

*æœ¬æ–‡æ¡£å±•ç¤ºäº†æˆ‘ä»¬åœ¨AIæŠ€æœ¯åº”ç”¨æ–¹é¢çš„æ·±åº¦å®è·µå’Œåˆ›æ–°æˆæœï¼Œä½“ç°äº†ç°ä»£åŒ–æ•°å­—åšç‰©é¦†å»ºè®¾çš„æŠ€æœ¯å®åŠ›å’Œå‘å±•æ½œåŠ›ã€‚æˆ‘ä»¬è‡´åŠ›äºé€šè¿‡å…ˆè¿›çš„AIæŠ€æœ¯ï¼Œä¸ºéç‰©è´¨æ–‡åŒ–é—äº§çš„ä¼ æ‰¿å’Œå‘å±•è´¡çŒ®åŠ›é‡ã€‚*
